before:
  hooks:
    - make clean

builds:
  - binary: reaper
    env:
      - CGO_ENABLED=0
    goos:
      - darwin
      - linux
      - windows
    goarch:
      - amd64
    ldflags:
      - "-w -s -X github.com/chanzuckerberg/reaper/util.GitSha={{.Commit}} -X github.com/chanzuckerberg/reaper/util.Version={{.Version}} -X github.com/chanzuckerberg/reaper/util.Dirty=false -X github.com/chanzuckerberg/reaper/util.Release=true"

archive:
  files:
  - none*

release:
  prerelease: true

dockers:
  -
    goos: linux
    goarch: amd64
    dockerfile: Dockerfile.release
    binaries:
    - reaper
    image_templates:
    - "chanzuckerberg/reaper:latest"
    - "chanzuckerberg/reaper:{{ .Version }}"